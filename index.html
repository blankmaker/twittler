<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="underscore.js"></script>
    <link type="text/css" rel="stylesheet" href="dn_twittler.css"/>
  </head>
  <body>
    <h1>Twittler!</h1>
    <button id="refreshButton">See more tweets</button>
    <!-- 
    1) show X more tweets in button
    2) Use jQuery to collapse all tweets that weren't loaded in that round
    3) Create button to show all those hidden tweets
    4) Create new page to show new tweets
    5) Format time
    -->
    <div id="tweetFeed">
    </div>
    <script>
      $(document).ready(function(){
       var tweetArray = streams.home;
       var masterArray = [];

       var makeTweet = function(tweet) {
        var $tweetContainer = $("<div class='tweetContainer'></div>");
        $tweetContainer.append("<p class='user'>" +tweet.user+ "</p>");
        $tweetContainer.append("<p class='message'>" +tweet.message+ "</p>");
        $tweetContainer.append("<p class='time'>" +tweet.created_at+ "</p>");
        return $tweetContainer;
       };

       var displayTweetsOnLoad = function() { 
        var $tweetSet = $("<div class='tweetSet'></div>"); //could this be refactored?
        $tweetSet.prependTo($("#tweetFeed"));

        _.each(tweetArray, function(tweet) {
        var $newTweet = makeTweet(tweet);
        $newTweet.appendTo($tweetSet);
        masterArray.push(tweet);
        });

        tweetArray.splice(0,tweetArray.length);        
      };

      $("button").on("click", function() {
        var $tweetSet = $("<div class='tweetSet'></div>"); 
        $tweetSet.prependTo($("#tweetFeed"));

        _.each(tweetArray, function(tweet, index) {
        var $newTweet = makeTweet(tweet);
        $newTweet.prependTo($tweetSet);
        masterArray.push(tweet);
        });

        tweetArray.splice(0,tweetArray.length);  
      })

      displayTweetsOnLoad();


      

      });

    </script>
  </body>
</html>


